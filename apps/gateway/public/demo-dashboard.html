<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PFI - Dashboard Temps R√©el</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-red: #ef4444;
            --border: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 2rem;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .header .status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--accent-green);
        }
        
        .header .status::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }
        
        .card h2 {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .card .value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .card .label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }
        
        .card.success .value { color: var(--accent-green); }
        .card.warning .value { color: var(--accent-yellow); }
        .card.error .value { color: var(--accent-red); }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        .panel {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
        }
        
        .panel-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .panel-header h3 {
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .panel-header .badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            background: var(--accent-blue);
        }
        
        .panel-content {
            padding: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .hl7-message {
            font-family: 'Fira Code', 'Monaco', monospace;
            font-size: 0.75rem;
            background: #0f172a;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
        }
        
        .hl7-message .segment {
            color: var(--accent-blue);
        }
        
        .hl7-message .field {
            color: var(--text-secondary);
        }
        
        .fhir-resource {
            font-family: 'Fira Code', 'Monaco', monospace;
            font-size: 0.75rem;
            background: #0f172a;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
        }
        
        .fhir-resource .key { color: var(--accent-blue); }
        .fhir-resource .string { color: var(--accent-green); }
        .fhir-resource .number { color: var(--accent-yellow); }
        
        .compliance-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        
        .compliance-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-dark);
            border-radius: 8px;
        }
        
        .compliance-item .icon {
            font-size: 1.25rem;
        }
        
        .compliance-item .text {
            font-size: 0.875rem;
        }
        
        .compliance-item.pass { border-left: 3px solid var(--accent-green); }
        .compliance-item.fail { border-left: 3px solid var(--accent-red); }
        .compliance-item.pending { border-left: 3px solid var(--accent-yellow); }
        
        .timestamp {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 1rem;
            text-align: right;
        }
        
        .full-width {
            grid-column: span 2;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè• PFI - Tableau de Bord Temps R√©el</h1>
        <div class="status">Connect√© ‚Ä¢ Derni√®re MAJ : <span id="lastUpdate">--:--:--</span></div>
    </div>
    
    <div class="grid">
        <div class="card success">
            <h2>Messages HL7 Re√ßus</h2>
            <div class="value" id="hl7Count">128</div>
            <div class="label">Aujourd'hui</div>
        </div>
        <div class="card success">
            <h2>Ressources FHIR Cr√©√©es</h2>
            <div class="value" id="fhirCount">342</div>
            <div class="label">Observations + Patients</div>
        </div>
        <div class="card success">
            <h2>Documents CDA</h2>
            <div class="value" id="cdaCount">45</div>
            <div class="label">Publi√©s vers DMP</div>
        </div>
    </div>
    
    <div class="main-grid">
        <!-- Dernier message HL7 -->
        <div class="panel">
            <div class="panel-header">
                <h3>üì® Dernier Message HL7</h3>
                <span class="badge">ORU^R01</span>
            </div>
            <div class="panel-content">
                <div class="hl7-message">
<span class="segment">MSH</span>|^~\&|LABO|LAB01|PFI|GATEWAY|20260129110928||<span class="segment">ORU^R01</span>|MSG12345|P|2.5<br>
<span class="segment">PID</span>|1||<span class="field">178037512345678</span>^^^INS^NH||DURAND^PIERRE^JEAN||19780322|M<br>
<span class="segment">OBR</span>|1||LAB001|24356-8^Urinalysis^LN|||20260129110000<br>
<span class="segment">OBX</span>|1|NM|<span class="field">2339-0</span>^Glucose^LN||<span class="field">5.8</span>|mmol/L|3.9-6.1|N|||F<br>
<span class="segment">OBX</span>|2|NM|2160-0^Creatinine^LN||88|umol/L|62-106|N|||F
                </div>
                <div class="timestamp">Re√ßu √† 11:09:28</div>
            </div>
        </div>
        
        <!-- Ressource FHIR Patient -->
        <div class="panel">
            <div class="panel-header">
                <h3>üë§ Ressource FHIR Patient</h3>
                <span class="badge">QUALIFIED</span>
            </div>
            <div class="panel-content">
                <div class="fhir-resource">
{<br>
&nbsp;&nbsp;<span class="key">"resourceType"</span>: <span class="string">"Patient"</span>,<br>
&nbsp;&nbsp;<span class="key">"id"</span>: <span class="string">"pat-178037512345678"</span>,<br>
&nbsp;&nbsp;<span class="key">"identifier"</span>: [{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"system"</span>: <span class="string">"urn:oid:1.2.250.1.213.1.4.5"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"value"</span>: <span class="string">"178037512345678"</span><br>
&nbsp;&nbsp;}],<br>
&nbsp;&nbsp;<span class="key">"name"</span>: [{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"use"</span>: <span class="string">"official"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"family"</span>: <span class="string">"DURAND"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"given"</span>: [<span class="string">"PIERRE"</span>, <span class="string">"JEAN"</span>]<br>
&nbsp;&nbsp;}],<br>
&nbsp;&nbsp;<span class="key">"birthDate"</span>: <span class="string">"1978-03-22"</span>,<br>
&nbsp;&nbsp;<span class="key">"gender"</span>: <span class="string">"male"</span><br>
}
                </div>
                <div class="timestamp">Qualifi√© √† 11:08:45</div>
            </div>
        </div>
        
        <!-- Conformit√© S√©gur -->
        <div class="panel full-width">
            <div class="panel-header">
                <h3>‚úÖ Statut Conformit√© S√©gur</h3>
                <span class="badge" style="background: var(--accent-green);">100% CONFORME</span>
            </div>
            <div class="panel-content">
                <div class="compliance-grid">
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>INS Qualifi√©</strong> - OID 1.2.250.1.213.1.4.5</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>Nom Officiel</strong> - HumanName.use = "official"</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>LOINC Codes</strong> - Observations cod√©es</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>UCUM Units</strong> - mmol/L valid√©</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>CDA CI-SIS</strong> - Template ANS</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>Audit Trail</strong> - Toutes transactions trac√©es</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>TLS 1.3</strong> - Chiffrement actif</span>
                    </div>
                    <div class="compliance-item pass">
                        <span class="icon">‚úÖ</span>
                        <span class="text"><strong>Lien Patient</strong> - Z√©ro r√©sultat orphelin</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Mise √† jour de l'heure
        function updateTime() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = 
                now.toLocaleTimeString('fr-FR');
        }
        
        // Simulation de compteurs qui augmentent
        function updateCounters() {
            const hl7 = document.getElementById('hl7Count');
            const fhir = document.getElementById('fhirCount');
            const cda = document.getElementById('cdaCount');
            
            // Incr√©menter al√©atoirement
            if (Math.random() > 0.7) {
                hl7.textContent = parseInt(hl7.textContent) + 1;
                fhir.textContent = parseInt(fhir.textContent) + Math.floor(Math.random() * 3) + 1;
            }
            if (Math.random() > 0.9) {
                cda.textContent = parseInt(cda.textContent) + 1;
            }
        }
        
        // D√©marrer les mises √† jour
        updateTime();
        setInterval(updateTime, 1000);
        setInterval(updateCounters, 3000);
    </script>
</body>
</html>
